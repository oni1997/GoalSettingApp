@using GoalSettingApp.Models

<div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5)">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">@Goal.Title</h5>
                <button type="button" class="btn-close" @onclick="Close"></button>
            </div>

            <div class="modal-body">
                <p><strong>Description:</strong> @Goal.Description</p>
                <p><strong>Category:</strong> @Goal.Category</p>
                <p><strong>Priority:</strong> @Goal.Priority</p>
                <p><strong>Due Date:</strong> @(Goal.DueDate?.ToString("MMM d, yyyy") ?? "—")</p>
                <p><strong>Created:</strong> @Goal.CreatedAt.ToString("MMM d, yyyy")</p>

                @if (Goal.IsRecurring)
                {
                    <hr />
                    <div class="d-flex align-items-center gap-3">
                        <div>
                            <span class="badge bg-info">↻ @Goal.Recurrence</span>
                        </div>
                        @if (Goal.CompletionCount > 0)
                        {
                            <div>
                                <span class="badge bg-success">Completed @Goal.CompletionCount time(s)</span>
                            </div>
                        }
                    </div>
                }
            </div>

            <div class="modal-footer d-flex justify-content-between">

                <div>
                    <button class="btn btn-warning me-2" @onclick="EditClicked">Edit</button>
                    <button class="btn btn-danger" @onclick="DeleteClicked">Delete</button>
                </div>

                <div>
                    <button class="btn btn-secondary" @onclick="Close">Close</button>
                </div>

            </div>

        </div>
    </div>
</div>

@code {
    [Parameter] public Goal Goal { get; set; } = default!;

    [Parameter] public EventCallback OnClose { get; set; }

    [Parameter] public EventCallback<Goal> OnEdit { get; set; }
    [Parameter] public EventCallback<int> OnDelete { get; set; }

    private async Task Close() => await OnClose.InvokeAsync();

    private async Task EditClicked() => await OnEdit.InvokeAsync(Goal);
    private async Task DeleteClicked() => await OnDelete.InvokeAsync(Goal.Id);
}
